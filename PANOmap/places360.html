<!DOCTYPE html>
<html>
<head>
    <title>Places360 - Yilun's Site</title>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/pannellum@2.5.6/build/pannellum.css"/>

    <style>
        body { margin: 0; padding: 0; width: 100%; height: 100%; overflow: hidden; font-family: sans-serif; }
        #map { height: 100vh; width: 100%; z-index: 1; }

        /* --- NEW: Style for the black plus icon --- */
        .black-plus-icon {
            color: black;
            font-size: 37px;
            font-weight: bold;
            text-align: center;
            line-height: 37px; /* Center vertically within the icon box */
        }

        #page-title {
            position: fixed;
            top: 20px;
            left: 60px;
            z-index: 1000; /* Above map */

            font-size: 24px;
            font-weight: bold;
            color: #333;

            background-color: rgba(255, 255, 255, 0.8); /* Semi-transparent white */
            padding: 10px 15px;
            border-radius: 8px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
            pointer-events: none; /* Let clicks pass through if you don't want it selectable */
        }

        /* --- NEW: Back Button (Bottom Left) --- */
        #back-link {
            position: fixed;
            bottom: 20px;
            left: 10px;
            z-index: 1000;

            display: inline-block;
            text-decoration: none;
            color: #333;
            font-weight: bold;
            font-size: 10px;

            background-color: rgba(255, 255, 255, 0.9);
            padding: 10px 20px;
            border-radius: 50px; /* Pill shape to match quote box */
            box-shadow: 0 2px 10px rgba(0,0,0,0.2);
            transition: background 0.2s;
        }
        #back-link:hover {
            background-color: white;
            color: black;
        }

        #quote-box {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);

            background-color: rgba(255, 255, 255, 0);
            padding: 10px 20px;
            border-radius: 50px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);

            color: #333;
            font-size: 14px;
            z-index: 500;
            text-align: center;
            max-width: 80%;
        }

        #panorama-modal {
            display: none;
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 70%;
            height: 60%;
            background: #000;
            z-index: 2000;
            box-shadow: 0 20px 50px rgba(0,0,0,0.8);
            border: 4px solid white;
            border-radius: 8px;
        }

        #panorama { width: 100%; height: 100%; border-radius: 4px; }

        #close-btn {
            position: absolute;
            top: -15px;
            right: -15px;
            width: 30px; height: 30px;
            line-height: 30px;
            text-align: center;
            color: white;
            background: black;
            border-radius: 50%;
            cursor: pointer;
            z-index: 2001;
            font-weight: bold;
            box-shadow: 0 2px 5px rgba(0,0,0,0.5);
            border: 2px solid white;
        }
        #close-btn:hover { background: darkred; }

        @media (max-width: 600px) {
            #panorama-modal { width: 95%; height: 60%; }
        }
    </style>
</head>
<body>

    <div id="page-title">Places360</div>

    <a id="back-link" href="https://yilun595.github.io/life/">&#8592; Back</a>

    <div id="map"></div>

    <div id="quote-box">
    <i>"Human lives are a dialectical movement between shelter and venture, attachment and freedom."</i>  Yi-Fu Tuan (1977)
    </div>

    <div id="panorama-modal">
        <div id="close-btn" onclick="closePano()">X</div>
        <div id="panorama"></div>
    </div>

    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/pannellum@2.5.6/build/pannellum.js"></script>

    <script>
        // --- 1. SETUP MAP ---
        var map = L.map('map').setView([22.3593, 114.1694], 11);

        L.tileLayer('https://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}{r}.png', {
            attribution: '&copy; OpenStreetMap contributors &copy; CARTO',
            subdomains: 'abcd',
            maxZoom: 20
        }).addTo(map);

        // --- 2. PANO DATA ---
        var locations = [
            { lat: 22.417208, lng: 114.135856, title: "Tai Mo Shan", img: "/PANOmap/PanoLib/20241011TaiMao.jpg" },
            { lat: 22.357350, lng: 114.297055, title: "Sharp Island", img: "/PANOmap/PanoLib/20241005KiuTsui.jpg" },
            { lat: 22.540487, lng: 114.441308, title: "Tung Ping Chau", img: "/PANOmap/PanoLib/20240928TungPing.jpg" },
            { lat: 22.258430, lng: 114.295996, title: "Tung Lung Island", img: "/PANOmap/PanoLib/20240330TungLung.jpg" },
            { lat: 22.272173, lng: 114.136236, title: "High West", img: "/PANOmap/PanoLib/20230925HighWestNight.jpg" },
            { lat: 22.208062, lng: 114.259013, title: "Cape D'Aguilar", img: "/PANOmap/PanoLib/20231225.jpg" },
            { lat: 22.489690, lng: 114.208312, title: "Pat Sin Leng", img: "/PANOmap/PanoLib/20221231BatSin.jpg" },
            { lat: 22.284177, lng: 114.137722, title: "Loke Yew Hall", img: "/PANOmap/PanoLib/LukYewHall.jpg" },
            { lat: 22.258002, lng: 113.958012, title: "Sunset Peak", img: "/PANOmap/PanoLib/SunsetPeak.jpg" },
            { lat: 34.969033, lng: 135.781209, title: "Fushimiinari", img: "/PANOmap/PanoLib/Shrine.jpg" },
            { lat: 35.503478, lng: 138.776822, title: "Fujiyama Viewing Platform", img: "/PANOmap/PanoLib/Fuji.jpg" },
            { lat: 1.360722, lng: 103.812523, title: "Tree Top Walk", img: "/PANOmap/PanoLib/TreeTopWalk.jpg" },
            { lat: 22.282119, lng: 114.196963, title: "Red Incense Burner Summit", img: "/PANOmap/PanoLib/20230924.jpg" },
            { lat: 22.391994, lng: 114.149133, title: "Shing Mun Reservoir", img: "/PANOmap/PanoLib/20231126SingMun.jpg" },
            { lat: 22.272003, lng: 114.135906, title: "High West", img: "/PANOmap/PanoLib/20231119HighWest.jpg" },
            { lat: 22.358428, lng: 114.374550, title: "Po Pin Chau", img: "/PANOmap/PanoLib/20231112_PoPinChau.jpg" },
            { lat: 22.248071, lng: 113.933429, title: "Lantau Peak", img: "/PANOmap/PanoLib/20231021_Lantau.jpg" },
            { lat: 22.392056, lng: 114.252580, title: "Ngong Ping Campsite", img: "/PANOmap/PanoLib/20231015_OngPing.jpg" },
            { lat: 22.466120, lng: 114.091717, title: "Kai Kung Leng", img: "/PANOmap/PanoLib/20231001_GaiGong.jpg" },
            { lat: 22.278137, lng: 114.146835, title: "Victoria's Peak", img: "/PANOmap/PanoLib/20231205VictoriaPeak.jpg" },
            { lat: 22.348478, lng: 114.184445, title: "Lion Peak", img: "/PANOmap/PanoLib/20231203lionspeak.jpg" },
            { lat: 1.443342, lng: 103.736400, title: "Sungei Buloh Wetland Reserve", img: "/PANOmap/PanoLib/20251130Sungei.jpg" },
            { lat: 1.355677, lng: 103.799323, title: "Banyan Trail", img: "/PANOmap/PanoLib/20251129.jpg" },
            { lat: 22.237933, lng: 114.156736, title: "Yuk Kwai Shan", img: "/PANOmap/PanoLib/20231202ApLeiChau.jpg" },
            { lat: 48.172392, lng: 11.571414, title: "Luitpoldpark", img: "/PANOmap/PanoLib/20240701_Luitpoldpark.jpg" },
            { lat: 48.167249, lng: 11.550826, title: "Olympiapark", img: "/PANOmap/PanoLib/20240701_Olympiapark.jpg" },
            { lat: 48.147365, lng: 11.587055, title: "Englischen Garten", img: "/PANOmap/PanoLib/20240702_EnglishGarden.jpg" },
            { lat: 48.173009, lng: 11.546628, title: "Olympiastadion", img: "/PANOmap/PanoLib/20240705_Olympic.jpg" },
            { lat: 48.145823, lng: 11.565554, title: "Königsplatz", img: "/PANOmap/PanoLib/20240703_KingPlaza.jpg" },
            { lat: 48.163322, lng: 11.497748, title: "Botanical Garden Munich", img: "/PANOmap/PanoLib/20240704_botgarden.jpg" },
            { lat: 48.158165, lng: 11.499560, title: "Nymphenburg", img: "/PANOmap/PanoLib/20240704_Nymphenburg.jpg" },
            { lat: 48.144134, lng: 11.581796, title: "Dichtergarten", img: "/PANOmap/PanoLib/20240702_Dichtergarten.jpg" },
            { lat: 48.163853, lng: 11.502200, title: "Botanical Garden Munich", img: "/PANOmap/PanoLib/20240704_GreenHouse.jpg" },
            { lat: 48.138629, lng: 11.572666, title: "Frauenkirche", img: "/PANOmap/PanoLib/20240703_Church.jpg" },
            { lat: 49.457696, lng: 11.076879, title: "Kaiserburg Nürnberg", img: "/PANOmap/PanoLib/20240706_Numbrmberg.jpg" },

        ];

        // --- 3. RENDER MARKERS ---

        // Define the custom black plus icon
        var blackPlusIcon = L.divIcon({
            className: 'black-plus-icon',
            html: '+',
            iconSize: [28,28], // Size of the icon box
            iconAnchor: [12, 12] // Point of the icon which will correspond to marker's location (center)
        });

        locations.forEach(function(loc) {
            // Use the custom icon here
            var marker = L.marker([loc.lat, loc.lng], {icon: blackPlusIcon}).addTo(map);
            marker.bindTooltip(loc.title);
            marker.on('click', function() {
                openPano(loc.img, loc.title);
            });
        });

        // --- 4. VIEWER LOGIC ---
        var viewer;
        function openPano(imagePath, title) {
            var modal = document.getElementById('panorama-modal');
            modal.style.display = 'block';

            setTimeout(function(){
                if(viewer) viewer.destroy();
                viewer = pannellum.viewer('panorama', {
                    "type": "equirectangular",
                    "panorama": imagePath,
                    "autoLoad": true,
                    "autoRotate":5,
                    "showFullscreen": false
                });
            }, 50);
        }

        function closePano() {
            document.getElementById('panorama-modal').style.display = 'none';
            if(viewer) viewer.destroy();
        }
    </script>
</body>
</html>